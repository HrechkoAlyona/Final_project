/* frontend/src/components/PostModal/PostModal.module.scss */

// Оверлей и кнопка закрытия
.overlay {
  position: fixed;
  top: 0; left: 0; width: 100vw; height: 100vh;
  background-color: rgba(0, 0, 0, 0.65);
  z-index: 1000;
  display: flex; justify-content: center; align-items: center;
}

.closeBtn {
  position: absolute; top: 20px; right: 20px;
  background: none; border: none; color: #fff;
  cursor: pointer; z-index: 2000;
  svg { width: 30px; height: 30px; }
}

.modalCard {
  background-color: #fff;
  width: 100%; max-width: 1100px;
  height: 85vh; 
  max-height: 800px;
  border-radius: 4px; 
  overflow: hidden;
  display: flex;
  animation: appear 0.2s ease-out;
}

@keyframes appear {
  from { transform: scale(1.05); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

// --- ЛЕВАЯ ЧАСТЬ (ФОТО) ---
.mediaSection {
  flex: 1.5;
  background-color: #fafafa;
  display: flex; justify-content: center; align-items: center;
  position: relative; 
  
  img { width: 100%; height: 100%; object-fit: contain; }
}

// --- СТИЛИ ДЛЯ ЗАГОЛОВКА ПОВЕРХ ФОТО ---
.imageOverlayTitle {
  position: absolute;
  bottom: 40px;      
  left: 20px;
  right: 20px;
  
  color: #fff;       
  font-size: 24px;   
  font-weight: 700;  
  line-height: 1.2;
  text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
  word-wrap: break-word; 
  text-align: left;
}

// Обертка для редактирования заголовка
.editTitleWrapper {
  width: 100%;
  display: flex; flex-direction: column;
  position: relative; // Важно для позиционирования инструментов
}

.overlayInput {
  width: 100%;
  background: rgba(0, 0, 0, 0.5); // Полупрозрачный фон
  border: 1px solid rgba(255, 255, 255, 0.7);
  color: #fff;
  font-size: 24px;
  font-weight: 700;
  padding: 8px;
  
  // Отступ справа, чтобы текст не наезжал на смайлик и счетчик
  padding-right: 90px; 
  
  border-radius: 4px;
  outline: none;
  
  &::placeholder {
    color: rgba(255, 255, 255, 0.7);
  }
}

// --- ПРАВАЯ ЧАСТЬ (ИНФО) ---
.contentSection {
  flex: 1; min-width: 350px; max-width: 450px;
  display: flex; flex-direction: column;
  background: #fff;
  border-left: 1px solid #efefef;

  // Z-index чтобы выпадающее окно смайлов перекрывало картинку слева
  position: relative;
  z-index: 10; 
}

// 1. Шапка автора
.header {
  padding: 14px 16px; border-bottom: 1px solid #efefef;
  display: flex; align-items: center; gap: 12px;
  
  img { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; border: 1px solid #dbdbdb; }
  .username { font-weight: 600; font-size: 14px; color: #262626; &:hover { opacity: 0.7; cursor: pointer; } }
}

// 2. Список комментариев (ОБЫЧНЫЙ РЕЖИМ)
.commentsList {
  flex: 1; overflow-y: auto; padding: 16px;
  display: flex; flex-direction: column; gap: 16px;
  &::-webkit-scrollbar { width: 4px; }
  &::-webkit-scrollbar-thumb { background-color: #dbdbdb; border-radius: 4px; }
}

// 2.1 Контейнер для режима РЕДАКТИРОВАНИЯ (без прокрутки)
.editorContainer {
  flex: 1; 
  padding: 16px;
  display: flex; flex-direction: column;
  overflow: visible; // Позволяет окну смайлов выходить влево
}

.commentItem {
  display: flex; gap: 12px;
  img { width: 32px; height: 32px; border-radius: 50%; object-fit: cover; flex-shrink: 0; }
  .commentContent {
    font-size: 14px;
    .commentUsername { font-weight: 600; margin-right: 5px; }
    .commentText { color: #262626; line-height: 1.4; }
    .commentTime { display: block; margin-top: 4px; font-size: 12px; color: #8e8e8e; }
  }
}

// 3. Футер
.footer { border-top: 1px solid #efefef; background: #fff; display: flex; flex-direction: column; }
.actionIcons {
  padding: 12px 16px 8px; display: flex; gap: 16px;
  svg { font-size: 24px; cursor: pointer; color: #262626; &:hover { color: #8e8e8e; } }
}
.likesCount { padding: 0 16px; font-weight: 600; font-size: 14px; margin-bottom: 8px; }
.postDate { padding: 0 16px 12px; font-size: 10px; text-transform: uppercase; color: #8e8e8e; }

// 4. Поле ввода
.addCommentBox {
  border-top: 1px solid #efefef; padding: 12px 16px; display: flex; align-items: center; gap: 10px;
  input { flex: 1; border: none; outline: none; font-size: 14px; }
  button {
    background: none; border: none; color: #0095f6; font-weight: 600; font-size: 14px; cursor: pointer;
    &:disabled { opacity: 0.3; }
    &:hover:not(:disabled) { color: #00376b; }
  }
}

// --- ОКНО ДЕЙСТВИЙ (Options Modal) ---
.moreBtn {
  background: none; border: none; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  margin-left: auto; padding: 8px;
  svg { font-size: 24px; color: #262626; }
  &:hover { opacity: 0.6; }
}

.optionsOverlay {
  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
  background-color: rgba(0, 0, 0, 0.65);
  z-index: 3000;
  display: flex; justify-content: center; align-items: center;
}

.optionsCard {
  background: #fff; width: 400px; max-width: 90vw;
  border-radius: 12px; overflow: hidden;
  display: flex; flex-direction: column;
  animation: appear 0.1s ease-out;
}

.optionBtn {
  background: #fff; border: none; border-bottom: 1px solid #dbdbdb;
  padding: 14px; font-size: 14px; cursor: pointer;
  width: 100%; color: #262626; font-weight: 400;
  &:last-child { border-bottom: none; }
  &:active { background-color: #efefef; }
}

.dangerBtn { color: #ed4956; font-weight: 700; }

// --- СТИЛИ РЕДАКТИРОВАНИЯ ---

// Текстовое поле описания
.editTextArea {
  width: 100%; height: 100%;
  border: none; resize: none; outline: none;
  font-family: inherit; font-size: 14px;
  line-height: 1.4;
  padding: 5px;
}

// Контейнер инструментов (смайл + счетчик)
.tools {
  display: flex; justify-content: space-between; align-items: center;
  padding: 10px 0;
  position: relative; 
}

// Инструменты заголовка (Абсолютное позиционирование справа)
.overlayTools {
  position: absolute;
  right: 10px;        
  top: 50%;           
  transform: translateY(-50%); 
  
  padding: 0;        
  gap: 10px;          
  
  .emojiBtn { color: #fff; &:hover { opacity: 0.8; } }
  .counter { color: rgba(255, 255, 255, 0.8); font-weight: 400; }
  
  // Окно смайлов для заголовка
  .emojiPickerPopover {
     left: auto;
     right: 0; // Выравниваем по правому краю
     
     //  Открываем ВВЕРХ
     top: auto;       // Отключаем открытие вниз
     bottom: 35px;    // Поднимаем окно вверх (над смайликом)
  }
}


.emojiBtn {
  cursor: pointer; font-size: 24px; color: #8e8e8e;
  display: flex; align-items: center;
  &:hover { color: #262626; }
}

.counter { font-size: 12px; color: #c7c7c7; }

// --- ОКНО СМАЙЛИКОВ (Базовое) ---
.emojiPickerPopover {
  position: absolute; 
  z-index: 20;
  background-color: #fff;
  box-shadow: 0 5px 15px rgba(0,0,0,0.2); 
  border-radius: 8px;
  top: 40px; 
  left: 0;
}

// --- ДЛЯ ОПИСАНИЯ: Влево и Вверх ---
.popoverUp {
  top: auto; bottom: 0;        
  left: auto; right: 100%;      
  margin-right: 15px; 
  
  &::after {
    content: '';
    position: absolute;
    top: 85%; right: -8px;
    width: 0; height: 0;
    border-top: 8px solid transparent;
    border-bottom: 8px solid transparent;
    border-left: 8px solid #fff;
  }
}

// Адаптив
@media (max-width: 850px) {
  .modalCard { flex-direction: column; height: 100%; width: 100%; border-radius: 0; overflow-y: auto; }
  .closeBtn { color: #000; top: 10px; right: 10px; }
  .mediaSection { height: 50vh; flex: none; }
  .contentSection { flex: 1; border-left: none; }
  .commentsList { min-height: 200px; }
  
  .popoverUp {
    right: 0; left: auto;
    margin-right: 0;
    bottom: 45px; 
    &::after { display: none; }
  }
}